<VirtualHost *:80>

    ServerName www.direct-medica-dev.com
    ServerAlias direct-medica-dev.com
    DocumentRoot /var/www/html/public
    PassEnv APP_ENV
    PassEnv API_VERSION
    PassEnv APP_LOCAL_PROJECT_URL
    PassEnv APP_SECRET
    PassEnv DATABASE_URL
    PassEnv JWT_SECRET_KEY
    PassEnv JWT_PUBLIC_KEY
    PassEnv JWT_PASSPHRASE
    PassEnv CORS_ALLOW_ORIGIN
    PassEnv AWS_ACCESS_KEY
    PassEnv AWS_SECRET_KEY
    PassEnv AWS_REGION
    PassEnv AWS_BUCKET_NAME
    <Directory /var/www/html/public>
        AllowOverride All
        Require all granted
        Allow from All

        <IfModule mod_rewrite.c>
            Options -MultiViews
            RewriteEngine On
            RewriteCond %{HTTP:Authorization} ^(.+)$
            RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]
            SetEnvIf Authorization "(.*)" HTTP_AUTHORIZATION=$1
            RewriteCond %{REQUEST_FILENAME} !-f
            RewriteRule ^(.*)$ /index.php [QSA,L]
        </IfModule>
    </Directory>

    <Directory /var/www/html/public/build>
        <IfModule mod_rewrite.c>
            RewriteEngine Off
        </IfModule>
    </Directory>

    ErrorLog /var/log/apache2/project_error.log
    CustomLog /var/log/apache2/project_access.log combined
</VirtualHost>
